<%=
  component_wrapper(data: wrapper_data_attributes, class: "work-packages-activities-tab-journals-item-component") do
    flex_layout(data: { "test_selector": "op-wp-journal-entry-#{journal.id}" }) do |journal_container|
      if show_comment_container?
        journal_container.with_row(classes: "journal-notes-border-box") do
          render(border_box_container(
            id: "activity-#{journal.version}",
            padding: :condensed
          )) do |border_box_component|
            border_box_component.with_header(px: 2, py: 0, classes: "journal-notes-header") do
              flex_layout(align_items: :center, justify_content: :space_between) do |header_container|
                header_container.with_column(flex_layout: true) do |header_start_container|
                  header_start_container.with_column(mr: 2) do
                    render Users::AvatarComponent.new(user: journal.user, show_name: false, size: :mini)
                  end
                  header_start_container.with_column(mr: 1) do
                    render(Primer::Beta::Link.new(
                      href: user_url(journal.user),
                      target: "_blank",
                      scheme: :primary,
                      underline: false, 
                      font_weight: :bold
                    )) do
                      journal.user.name
                    end
                  end
                  header_start_container.with_column(mr: 1, classes: "hidden-for-mobile") do
                    if journal.initial?
                      render(Primer::Beta::Text.new(color: :subtle, mt: 1)) do
                        t("activities.work_packages.activity_tab.created_on")
                      end
                    else
                      render(Primer::Beta::Text.new(color: :subtle, mt: 1)) do
                        t("activities.work_packages.activity_tab.commented_on")
                      end
                    end
                  end
                  header_start_container.with_column(mr: 1) do
                    render(Primer::Beta::Text.new(color: :subtle, mt: 1)) { format_time(journal.updated_at) }
                  end
                end
                header_container.with_column(flex_layout: true, align_items: :center) do |header_end_container|
                  if has_unread_notifications?
                    header_end_container.with_column(mr: 2, pt: 1) do
                      bubble_html
                    end
                  end
                  header_end_container.with_column do
                    render(Primer::Beta::Link.new(
                      href: activity_anchor,
                      scheme: :secondary,
                      underline: false, 
                      font_size: :small,
                      data: { turbo: false }
                    )) do
                      "##{journal.version}"
                    end
                  end
                  header_end_container.with_column(ml: 2) do
                    render(Primer::Alpha::ActionMenu.new) do |menu|
                      menu.with_show_button(icon: "kebab-horizontal",
                                            'aria-label': I18n.t(:button_actions),
                                            scheme: :invisible)
                      copy_url_action_item(menu)
                      edit_action_item(menu) if editable?
                      quote_action_item(menu) if journal.notes.present?
                    end
                  end
                end
              end
            end
            border_box_component.with_body(classes: "journal-notes-body") do
              content
            end
          end
        end
      end
      journal_container.with_row do
        render(WorkPackages::ActivitiesTab::Journals::ItemComponent::Details.new(journal:, has_unread_notifications: notification_on_details?, filter:))
      end
    end
  end
%>
